See discussions, st ats, and author pr ofiles for this publication at : https:

/www .r esearchgate.ne t /public ation/329000677

NetPSO: Gradient-free optimization method for the discovery of stimuli which
drive speciﬁc network dynamics

Preprint · November 2018

DOI: 10.13140/RG.2.2.31712.53761

CITATIONS

0

2 author s:

Jimin Kim
University of Washington Seattle

6

 PUBLICATIONS   8

 CITATIONS   

SEE PROFILE

Some of the authors of this publication are also working on these related projects:

Chaotic Dynamics View project

Dimension Reduction of Dynamics View project

READS

32

Eli Shlizerman
University of Washington Seattle

51

 PUBLICATIONS   366

 CITATIONS   

SEE PROFILE

All content following this page was uploaded by Eli Shlizerman on 16 No vember 2018.

The user has requested enhancement of the downloaded file.

/
NetPSO: Gradient-free optimization method for the discovery of stimuli
which drive speciﬁc network dynamics

Jimin Kim and Eli Shlizerman

Abstract— We develop a novel method, NetPSO, for dis-
covery of optimal neuronal network stimuli which enable
the network to achieve given dynamics. NetPSO is a gen-
eralization of Particle Swarm Optimization (PSO), which
is a gradient free biologically inspired algorithm designed
to mimic swarm intelligence and operates with three steps,
exploration, experience and mimicking. The steps guide a
large set of particles to search for the optimal solution in col-
laboration with each other. To test the approach, we apply our
method to an example Random Recurrent Neural Network
with dynamic connectivity and excitatory/inhibitory neurons.
We show that NetPSO is able to converge successfully on all
trials to the inputs which give rise to the given dynamics.
We also apply the NetPSO method to the neuronal network
model of Caenorhabditis elegans (C. elegans) to investigate
plausible stimuli which give rise to speciﬁc neural dynamics
of the full somatic nervous system. In particular, we aim to
discover constant input currents, within the locomotion sub-
circuit, which trigger oscillatory dynamics in motor neurons
associated with traveling wave propagating from anterior-to-
posterior direction of the body. Our results show that we
are able to recover stimuli that produce such dynamics. In
addition, we observe that NetPSO can ﬁnd alternative stimuli
that lead to similar dynamics. Such functionality allows to
explore stimulation of networks for which neural recordings
are available, but their structure is unknown.

I . ADD I T IONAL D ETA I L

Particle Swarm Optimization (PSO) algorithm is a
biologically inspired gradient free optimization routine
designed to mimic the behavior of ﬂocking birds or
schooling ﬁsh [1]. The central concept is to deﬁne a
set of particles which iteratively update their positions
and velocities according to simple mathematical rule
such that the particles search for the optimal solution
in a collaborative manner. While all particles are trying
to reach the same goal, they take distinct approaches.
In each time instance, each particle has a chance to
update its state according to its directions of change.
The directions of change are determined by three main
forces: Exploration, Experience and Mimicking. The
weighted sum of the three forces determines ﬁnal
direction of change for the particle. More speciﬁcally,
the forces are: Exploration: Keep the action the
particle took in the previous time step with some
randomness. Experience: Navigate toward the best
action this particle has ever taken so far. Mimicking:

Fig. 1.

Application of NetPSO to 3-Node 2-Channel Random
Recurrent Neural Network. Top: Comparison of neural network

activity generated by a network stimulated according to NetPSO (top)
with Ground truth network (bottom). Bottom left: Convergence rate of
the cost function used by NetPSO. Bottom right: connectivity structure
of the network; blue nodes-excitatory, red nodes-inhibitory.

(cid:1)

k

k

k+1

k + vi
k + c1 r1

k+1 = xi
k+1 = wk vi

Follow the direction of the best performed ”other”
particle in the current
time step. The above steps
determine the following equations for the position and
velocity update of each particle:
(cid:0) pi
(cid:1) + c2 r2
(cid:0) pg
Posit ion : xi
Vel ocit y : vi
k − xi
k − xi
where subscripts k and k + 1 indicate the k-th and
(k + 1)-th time instances, the superscript i indicates
the i-th particle out of the particle swarm, c1 and c2
are the two weighting values for balancing the local
(experience) and global (mimicking) optimal force, wk
is the discounting weight indicating the probability of
the particle to keep the previous state xi
k , r1 and r2 are
random ﬂoating point values to introduce randomness
to the behavior of particles, and ﬁnally pi
k and pg
k are
the local and global optimal states at time k. The fact
that PSO does not include assumptions regarding the
problem being solved and does not require the opti-
mization problem to be differentiable makes it a viable
method for discovery of functional stimuli of neuronal
networks. In particular, we propose a generalization
which searches the stimuli space, with each particle
being a stimulus candidate and the cost is deﬁned

model of C. elegans full somatic nervous system (279
neurons). To obtain the Ground Truth neural dynamics,
we stimulate PLML and PLMR sensory neurons,
and AVBL and AVBR inter neurons with constant
stimuli (2.3nA to AVBL/R and 1.4nA to PLML/R).
These stimuli are associated with the posterior touch
response and trigger forward locomotion. The neural
dynamics associated with it are expressed as traveling
waves of neural activity from anterior to posterior
along the body. The model indeed exhibits such char-
acteristic oscillations and we record them as Ground
Truth dynamics (Fig. 2). We then set
the number
of particles in NetPSO to 50 and utilize the method
to recover the PLM and AVB stimuli. Optimization
converges after approximately 40 iterations to stimuli
values of (AVBL, AVBR, PLMR, PLML)=[3.3nA,
0nA, 1.3nA, 1.3nA] (Fig.2 NetPSO). The converged
stimuli for PLM are similar to those in the Ground
Truth scenario, while stimulus of AVB is signiﬁcantly
different. However, when we compare the similarity of
neural dynamics obtained by NetPSO network with the
Ground Truth we ﬁnd remarkable similarity between
the two activity proﬁles (Fig.2). Notably, when we
attempt to ﬁnd stimuli using the conventional Gradient
descent method, such an approach fails to converge
and the dynamics that the resulting network produces
are substantially different in frequency amplitude and
synchronization between different neurons’ dynamics
(Fig.2 top). Indeed, these results are consistent with
the anatomical connectivity, since AVBR forms gap
junction with AVBL, such that stimulation of AVBL
alone can entrain AVBR and produce dynamics close
to dynamics produced by the Ground Truth stimuli.
Furthermore,
these results indicate that NetPSO is
applicable for discovery of novel stimuli,
if such
stimuli exist, and potentially characterize families of
stimuli resulting in similar dynamics.

R E F ER ENC E S

[1] Kennedy J. Particle swarm optimization. InEncyclopedia of ma-
chine learning 2011 (pp. 760-766). Springer, Boston, MA.
[2] Kunert, J., Shlizerman, E. and Kutz, J.N., 2014. Low-dimensional
functionality of complex network dynamics: Neurosensory integra-
tion in the Caenorhabditis elegans connectome. Physical Review
E, 89(5), p.052805.
[3] Kim, J., Leahy, W. and Shlizerman, E., 2017. Neural Interactome:
Interactive Simulation of a Neuronal System. bioRxiv, p.209155.
[4] Liu H, Kim J, Shlizerman E. Functional connectomics from neural
dynamics: probabilistic graphical models for neuronal network
of Caenorhabditis elegans. Phil. Trans. R. Soc. B. 2018 Oct
19;373(1758):20170377.

Fig. 2. Discovery of stimuli in C. elegans nervous system model. Top:

Time series and raster plots of neural activity obtained from Gradient
descent, NetPSO and Ground Truth . With 50 particles, NetPSO con-
verges to AV BL = 3.3nA, AV BR = 0nA, PLML/R = 1.3nA within ∼ 100
iterations. Bottom left: Convergence rate of NetPSO. Bottom right:
Visualization of C. elegans somatic nervous system network [3].

as the error between stimulated and given network
dynamics. We call this variant of PSO, NetPSO.

A. Optimization of Input Parameters for Random Re-
current Neural Networks
To test the NetPSO approach, we ﬁrst apply it to
example Random Recurrent Neural Network consist-
ing of 3 neurons (2- excitatory, 1-inhibitory) and 2
channels between neurons (synaptic and gap connec-
tivity) for which we randomly choose constant stimuli,
simulate the network and record its dynamics (the
Ground Truth in Fig. 1). We then utilize NetPSO
with 20 particles to ﬁnd input stimuli which drive
the network to produce the recorded dynamics. We
observe that NetPSO successfully (up to error of
0.00083%) converges to stimuli used to produce the
Ground truth dynamics. As expected, the dynamics
of the network obtained by NetPSO indeed produces
raster plots indistinguishable from the Ground Truth
network dynamics, see Fig. 1. We obtain similar
results for various connectivity weights and stimuli
drawn randomly.

B. Discovery of Stimuli in the Somatic Nervous System
Model of C. elegans
To test the performance of NetPSO on large net-
works we proceed and apply it
to the dynamical

View publication stats
View publication stats

